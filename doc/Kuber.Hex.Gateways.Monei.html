    <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.18.1">
    <title>Kuber.Hex.Gateways.Monei – kuber_hex v0.0.2</title>
    <link rel="stylesheet" href="dist/app-c922dbe7ef.css" />
    
    <script src="dist/sidebar_items-dbca2f57a8.js"></script>
    
    
    
    
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

    <div class="main">
<button class="sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<section class="sidebar">

  
  <a href="api-reference.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        kuber_hex
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.0.2
      </h2>
    </div>
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    

    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


      <h1>
        <small class="visible-xs">kuber_hex v0.0.2</small>
        Kuber.Hex.Gateways.Monei
        
      </h1>

      
        <section id="moduledoc">
          <p>An API client for the <a href="https://www.monei.net">MONEI</a> gateway.</p>
<p>For reference see <a href="https://docs.monei.net">MONEI’s API (v1) documentation</a>.</p>
<p>The following features of MONEI are implemented:</p>
<ul>
<li><p><code class="inline">PA</code> <strong>Pre-Authorize</strong><br/>
In <a href="#authorize/3"><code class="inline">authorize/3</code></a>.</p>
</li>
<li><p><code class="inline">CP</code> <strong>Capture</strong><br/>
In <a href="#capture/3"><code class="inline">capture/3</code></a>.</p>
</li>
<li><p><code class="inline">RF</code> <strong>Refund</strong><br/>
In <a href="#refund/3"><code class="inline">refund/3</code></a> and <del>also <a href="#void/2"><code class="inline">void/2</code></a></del>.</p>
</li>
<li><p><code class="inline">RV</code> <strong>Reversal</strong><br/>
In <a href="#void/2"><code class="inline">void/2</code></a>.</p>
</li>
<li><p><code class="inline">DB</code> <strong>Debit</strong><br/>
In <a href="#purchase/3"><code class="inline">purchase/3</code></a>.</p>
</li>
<li><p><strong>Tokenization</strong> and <strong>Registrations</strong><br/>
In <a href="#store/2"><code class="inline">store/2</code></a> <del>and <a href="#unstore/2"><code class="inline">unstore/2</code></a></del>.</p>
</li>
</ul>
<h2 id="module-the-opts-argument" class="section-heading">
  <a href="#module-the-opts-argument" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  The <code class="inline">opts</code> argument
</h2>

<p>This is a <a href="https://hexdocs.pm/elixir/Keyword.html"><code class="inline">Keyword</code></a> list of optional arguments for transactions with the MONEI
gateway. The following keys are supported:</p>
<table>
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th style="text-align: left">Key</th><th style="text-align: left">Remark</th><th style="text-align: left">Status</th>
</tr>
</thead>
<tr>
<td style="text-align: left"><code class="inline">billing_address</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">shipping_address</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">customer</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">shipping_customer</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">merchant</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">cart</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">invoice</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">customParameters</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
<tr>
<td style="text-align: left"><code class="inline">currency</code></td><td style="text-align: left"></td><td style="text-align: left">Not implemented</td>
</tr>
</table>
<h2 id="module-monei-quirks" class="section-heading">
  <a href="#module-monei-quirks" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  MONEI <em>quirks</em>
</h2>

<ul>
<li>MONEI does not process money in cents, and the <code class="inline">amount</code> is rounded to 2 decimal places.
</li>
</ul>
<h2 id="module-caveats" class="section-heading">
  <a href="#module-caveats" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Caveats
</h2>

<p>Although MONEI supports payments from <a href="https://support.monei.net/charges-and-refunds/accepted-credit-cards-payment-methods">various cards</a>, banks and virtual accounts (like some wallets), this library only accepts payments by (supported) cards.</p>
<h2 id="module-todo" class="section-heading">
  <a href="#module-todo" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  TODO
</h2>

<ul>
<li><p><a href="https://docs.monei.net/tutorials/manage-payments/backoffice">Backoffice operations</a></p>
<ul>
<li>Credit
</li>
<li>Rebill
</li>
</ul>
</li>
<li><a href="https://docs.monei.net/recurring">Recurring payments</a>
</li>
<li><a href="https://docs.monei.net/tutorials/reporting">Reporting</a>
</li>
</ul>

        </section>
      

      
        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
          

          
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
    <div class="summary-row">
  <div class="summary-signature">
    <a href="#authorize/3">authorize(amount, card, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Performs a (pre) Authorize operation</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#capture/3">capture(amount, paymentId, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Captures a pre-authorized <code class="inline">amount</code></p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#commit/4">commit(method, endpoint, params, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Makes the request to MONEI’s network</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#purchase/3">purchase(amount, card, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Credits the merchant account with <code class="inline">amount</code> by debiting the account of the customer</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#refund/3">refund(amount, paymentId, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Credits the account of the customer with a reference to a prior transfer</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#respond/1">respond(arg)</a>
  </div>
  
    <div class="summary-synopsis"><p>Parses MONEI’s response and returns a <code class="inline">Response</code> struct in a <code class="inline">:ok</code>, <code class="inline">:error</code> tuple</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#store/2">store(card, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Stores the payment-source data for later use</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#unstore/2">unstore(arg, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>WIP</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#validate_config/1">validate_config(config)</a>
  </div>
  
    <div class="summary-synopsis"><p>Validates the config dynamically depending on what is the value of <code class="inline">required_config</code></p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#void/2">void(paymentId, opts)</a>
  </div>
  
    <div class="summary-synopsis"><p>Voids the referenced payment</p>
</div>
  
</div>

  </div>


          

        </section>
      

      

      
        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Functions
          </h1>
          <div class="detail" id="authorize/3">
  
  
  <div class="detail-header">
    <a href="#authorize/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">authorize(amount, card, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>authorize(number(), Kuber.Hex.CreditCard, keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Performs a (pre) Authorize operation.</p>
<p>The authorization validates the <code class="inline">card</code> details with the banking network,
places a hold on the transaction <code class="inline">amount</code> in the customer’s issuing bank also
triggers risk management. Funds are not transferred.</p>
<p>MONEI returns an ID string which can be used to:</p>
<ul>
<li><a href="#capture/3"><code class="inline">capture/3</code></a> <em>an</em> amount.
</li>
<li><a href="#void/2"><code class="inline">void/2</code></a> a pre-authorization.
</li>
</ul>
<h3 id="authorize/3-note" class="section-heading">
  <a href="#authorize/3-note" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Note
</h3>

<p>A stand-alone pre-authorization <a href="https://docs.monei.net/tutorials/manage-payments/backoffice">expires in
72hrs</a>.</p>

  </section>
</div>
<div class="detail" id="capture/3">
  
  
  <div class="detail-header">
    <a href="#capture/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">capture(amount, paymentId, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>capture(number(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Captures a pre-authorized <code class="inline">amount</code>.</p>
<p><code class="inline">amount</code> is transferred to the merchant account by MONEI when it is smaller or
equal to the amount used in the pre-authorization referenced by <code class="inline">paymentId</code>.</p>
<h3 id="capture/3-note" class="section-heading">
  <a href="#capture/3-note" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Note
</h3>

<p>MONEI allows partial captures and unlike many other gateways, does not release
the remaining amount back to the payment source. Thus, the same
pre-authorisation ID can be used to perform multiple captures, till:</p>
<ul>
<li>all the pre-authorized amount is captured or,
</li>
<li>the remaining amount is explicitly “reversed” via <a href="#void/2"><code class="inline">void/2</code></a>. <strong>[citation-needed]</strong>
</li>
</ul>

  </section>
</div>
<div class="detail" id="commit/4">
  
  
  <div class="detail-header">
    <a href="#commit/4" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">commit(method, endpoint, params, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>commit(atom(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), keyword(), keyword()) ::
  {:ok, HTTPoison.Response} |
  {:error, HTTPoison.Error}</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Makes the request to MONEI’s network.</p>

  </section>
</div>
<div class="detail" id="purchase/3">
  
  
  <div class="detail-header">
    <a href="#purchase/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">purchase(amount, card, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>purchase(number(), Kuber.Hex.CreditCard, keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Credits the merchant account with <code class="inline">amount</code> by debiting the account of the customer.</p>
<p>MONEI attempts to debit the customer to accept a payment of <code class="inline">amount</code> with the
given <code class="inline">card</code>.</p>

  </section>
</div>
<div class="detail" id="refund/3">
  
  
  <div class="detail-header">
    <a href="#refund/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">refund(amount, paymentId, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>refund(number(), <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Credits the account of the customer with a reference to a prior transfer.</p>
<p>MONEI can process a full or partial refund worth <code class="inline">amount</code>, referencing a
previous <a href="#purchase/3"><code class="inline">purchase/3</code></a> or <a href="#capture/3"><code class="inline">capture/3</code></a>ed.</p>
<p>The end customer will always see two bookings/records on his statement.  Refer
MONEI’s <a href="https://docs.monei.net/tutorials/manage-payments/backoffice">Backoffice
Operations</a>
guide.</p>

  </section>
</div>
<div class="detail" id="respond/1">
  
  
  <div class="detail-header">
    <a href="#respond/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">respond(arg)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Parses MONEI’s response and returns a <code class="inline">Response</code> struct in a <code class="inline">:ok</code>, <code class="inline">:error</code> tuple.</p>

  </section>
</div>
<div class="detail" id="store/2">
  
  
  <div class="detail-header">
    <a href="#store/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">store(card, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>store(Kuber.Hex.CreditCard, keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Stores the payment-source data for later use.</p>
<p>MONEI can store the payment-source details, for example card or bank details
which can be used to effectively process <em>One-Click</em> and <em>Recurring</em> payments,
and return a registration token for reference.</p>
<p>It is recommended to associate these details with a “Customer” by passing
customer details in the <code class="inline">opts</code>.</p>
<h3 id="store/2-note" class="section-heading">
  <a href="#store/2-note" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Note
</h3>

<ul>
<li><em>One-Click</em> and <em>Recurring</em> payments are currently not implemented.
</li>
<li>Payment details can be saved during a <a href="#purchase/3"><code class="inline">purchase/3</code></a> or <a href="#capture/3"><code class="inline">capture/3</code></a>.
</li>
</ul>

  </section>
</div>
<div class="detail" id="unstore/2">
  
  
  <div class="detail-header">
    <a href="#unstore/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">unstore(arg, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>unstore(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>WIP</p>
<p><strong>MONEI unstore does not seem to work. MONEI always returns a <code class="inline">403</code></strong></p>
<p>Deletes previously stored payment-source data.</p>

  </section>
</div>
<div class="detail" id="validate_config/1">
  
  
  <div class="detail-header">
    <a href="#validate_config/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">validate_config(config)</span>
    
    
    
  </div>
  <section class="docstring">
    <p>Validates the config dynamically depending on what is the value of <code class="inline">required_config</code></p>

  </section>
</div>
<div class="detail" id="void/2">
  
  
  <div class="detail-header">
    <a href="#void/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">void(paymentId, opts)</span>
    
    
    
      <div class="specs">
        
          <pre>void(<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), keyword()) :: Kuber.Hex.Response</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Voids the referenced payment.</p>
<p>This method attempts a reversal of the <code class="inline">paymentId</code> referencing either a
previous <a href="#purchase/3"><code class="inline">purchase/3</code></a> or <a href="#authorize/3"><code class="inline">authorize/3</code></a>.</p>
<h2 id="void/2-voiding-a-previous-authorization" class="section-heading">
  <a href="#void/2-voiding-a-previous-authorization" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Voiding a previous authorization
</h2>

<p>MONEI will reverse the authorization by sending a “reversal request” to be
sent the payment source (card issuer) to clear the funds held against the
authorization. If some of the authorized amount was captured, only the
remaining amount is cleared. <strong>[citation-needed]</strong></p>
<h2 id="void/2-voiding-a-previous-purchase" class="section-heading">
  <a href="#void/2-voiding-a-previous-purchase" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Voiding a previous purchase
</h2>

<p>MONEI will reverse the payment, by sending all the amount back to the
customer.</p>
<p>As a consequence, the customer will never see any booking on his
statement. Refer MONEI’s <a href="https://docs.monei.net/tutorials/manage-payments/backoffice">Backoffice
Operations</a>
guide.</p>

  </section>
</div>

        </section>
      

      
          <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.18.1),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
        <button class="night-mode-toggle"><span class="sr-only">Switch theme</span></button>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-778c9ef903.js"></script>
  
  
  
  
  </body>
</html>

